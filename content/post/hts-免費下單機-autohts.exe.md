+++
title = "HTS 免費下單機 autohts.exe"
date = 2009-02-09T03:44:00Z
updated = 2010-01-13T17:57:18Z
tags = ["財經", "程式交易"]
blogimport = true 
[author]
	name = "TerryH"
	uri = "https://www.blogger.com/profile/00198432946574471177"
+++

<span style="font-size:180%;">免責申明</span><br /><br />autohts.exe 此程式，不保證任何正確性，所有責任使用者自負，程式很短，很髒，沒有設定，沒有視窗，不需 .NET，單一檔案，沒有商品，或是口數的限制，要跑幾個信號，就跑幾個，保證沒後門，哈哈，使用後，很滿意想捐錢贊助，請跟我連絡，下載點 <a href="http://autohts.googlecode.com/files/autohts.exe">http://autohts.googlecode.com/files/autohts.exe</a><br /><br /><span style="font-weight: bold;"><br /><span style="font-size:180%;">Why This</span></span><br /><br />好像一直找不到免費的，或是單純一點的，所以自己寫一個，程式沒有幾行，用日盛期貨下單API 下單，執行前，需先執行 C:\JihSun\HTS2\APITradeMgr.exe<br />然後，要複製 C:\JihSun\HTS2\Dll\HTSAPITradeClient.dll 到下單機程式的目錄，程式執行時，如果抱怨沒有 MSVCP71.dll，自行下載 <a href="http://www.dll-files.com/dllindex/dll-files.shtml?msvcp71">http://www.dll-files.com/dllindex/dll-files.shtml?msvcp71</a>，如果是XP可放在 C:/WINDOWS/SYSTEM32/ 下面即可<br /><br /><span style="font-size:180%;">執行方式</span><br /><span style="font-size:180%;"><br />autohts.exe 訊號檔名</span><br /><br />寫成一個批次檔就可以了�，要是不知道批次擋怎麼寫，我也有範例<br /><br /><span style="font-size:180%;">批次檔寫作</span><br /><br /><a href="http://terryh.tp.googlepages.com/auto.bat">http://terryh.tp.googlepages.com/auto.bat</a>，請自己用小作家就可以看內容了，依樣劃葫蘆就好，我的範例是下單機程式，和訊號檔都在 C:\JihSun\ 下面，然後，執行這一個批次檔就可以了<br />，auto.bat 的內容只有一行，所以我的是 C:\JihSun\autohts C:\JihSun\signal.txt，執行完自己的 auto.bat 後，他會停留在監控的視窗當中，然後，一有訊號，會有下單資料出現<br /><br />HTS 程式結尾，加上寫訊號的程式碼，我附上我的給您參考<br /><code><br />IF date = lastcalcdate and time = LastCalcTime THEN<br />    FileDelete("c:\JihSun\signal.txt")<br />    FileAppend("c:\JihSun\signal.txt",(NumToStr( Date,0)+","+NumToStr(Q_time,0)+",0,0,您的日盛帳戶碼,MXF,0,"+NumToStr(MarketPosition,0)))<br /><br />END IF<br /></code><br /><br /><br />程式不會轉倉，要自己處理<br /><br />訊號檔格式<br /><br />Date,time,contractdate,lots,acount,contractname,price,position<br /><br />Date  日期<br /><br />time  時間<br /><br />contracdarte 合約月份，ex: 200902，或是數字 0 代表近月<br /><br />lots 下單的口數，或是數字 0 代表 1 口<br /><br />account 您的日盛帳號<br /><br />contractname 合約名稱 TXF（臺股期貨），EXF（電子期貨），FXF（金融期貨），MXF（小型臺指期貨），也就是 API支援的都可以<br /><br />price 價位，數字0 就是市價(FOC)，0以外的就是限價(ROD)<br /><br />position 倉位，數字0 空手，1 多，-1 空<br /><span style="font-size:180%;"><br />訊號檔範例</span><br /><br />1090206,134459,0,0,000-1234567,MXF,0,0<br /><br />這就是 2009-02-06 13:44:59 近月合約 口數預設 帳號000-1234567 小台指 市價單 空手<br /><br /><br /><span style="font-weight: bold;font-size:180%;" >更新紀錄</span><br />2009-03-17 修正沒有訊號檔時，不會跳出程式，只是等待，新增程式版本資訊，再命令列下執行，不給訊號檔，就會列出說明及版本，現為V0.7<br />2009-03-11 修正程式在沒有訊號檔時候，不自動新建訊號檔，所以訊號檔一致由HTS 產生，請網友重新下載測試<br />2009-03-03 感謝網友 mmk 測試，發現在 HTS 4000 裡，輸出訊號檔，FileDelete 時，程式判斷錯誤，fixed<br />2009-03-02 感謝網友 mmk 測試，發現一開始沒有 lock file 的問題還再，已修正，我遜掉了<br />2009-02-19 修正，近月單，判斷月份錯誤<br />2009-02-18 修正成每次程式啟動，都會把lock file 清除，所以要執行時，請先同步自己的倉位，合程式同步，這樣更適合當沖<br />2009-02-10 修正一開始沒有 lock file 的問題<br />2009-02-09 First upload<br /><span style="font-weight: bold;"><br /><span style="font-size:180%;">Tips</span></span><br /><br />程式會自動產生一個和訊號檔同名附檔名為 lock 的參考檔來紀錄狀態，兩個檔案內容不同，就是倉位改變，只有判斷 position，另產生一個和訊號檔同名附檔名為 log 的紀錄檔
